/* =========================================================
   dark-fixes.css  —  Paleta + parches claro/oscuro unificados
   - Usa variables en :root (claro) y .dark (oscuro)
   - Aplica también con prefers-color-scheme: dark (fallback)
   - No toca tu JSX / lógica; sólo estilos
========================================================= */

/* ---------- Paleta base (CLARO) ---------- */
:root {
  --bg: #ffffff;
  --card: #ffffff;
  --soft: #f8fafc;           /* superficies suaves: inputs/pastillas */
  --text: #111827;           /* gris-900 */
  --muted: #6b7280;          /* gris-500 */
  --border: #e5e7eb;         /* gris-200 */
  --chip-bg: #f3f4f6;        /* gris-100 */
  --chip-text: #374151;      /* gris-700 */
  --link: #a21caf;           /* magenta de tu marca */
}

/* ---------- Paleta (OSCURA) por clase body.dark ---------- */
.dark {
  --bg: #0b1220;
  --card: #0f172a;
  --soft: #0b1427;
  --text: #e7e9ee;
  --muted: #a3acc2;
  --border: #253046;
  --chip-bg: #121a2e;
  --chip-text: #e7e9ee;
  --link: #f0abfc;
}

/* ---------- Fallback: si no usás .dark pero el SO está en dark ---------- */
@media (prefers-color-scheme: dark) {
  :root:not(.force-light) {
    --bg: #0b1220;
    --card: #0f172a;
    --soft: #0b1427;
    --text: #e7e9ee;
    --muted: #a3acc2;
    --border: #253046;
    --chip-bg: #121a2e;
    --chip-text: #e7e9ee;
    --link: #f0abfc;
  }
}

/* ---------- Fondo global + tipografía ---------- */
html, body { background: var(--bg); color: var(--text); }
a { color: var(--link); }

/* ---------- Cards / contenedores con borde ---------- */
.card,
.panel,
.box,
.rounded-xl.border,
.rounded-2xl.border,
.shadow,
.shadow-sm,
.shadow-md {
  background: var(--card) !important;
  border-color: var(--border) !important;
  color: var(--text);
}

/* Utilidades que quedaban muy blancas en dark */
.bg-white,
.bg-neutral-50,
.bg-slate-50,
.bg-gray-50,
.bg-zinc-50 {
  background: var(--soft) !important;
}
.text-neutral-800,
.text-neutral-700,
.text-gray-700 { color: var(--text) !important; }
.text-neutral-600,
.text-neutral-500,
.text-gray-600 { color: var(--muted) !important; }
.border-neutral-200,
.border-neutral-300,
.border-gray-200,
.border-gray-300 { border-color: var(--border) !important; }

/* ---------- Inputs / Selects / Textareas ---------- */
input[type="text"],
input[type="number"],
input[type="email"],
input[type="search"],
input[type="password"],
select,
textarea,
.input,
.select,
.textarea,
input.input,
select.input,
textarea.input {
  background: var(--soft) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}
input::placeholder,
textarea::placeholder,
.input::placeholder,
textarea.input::placeholder {
  color: var(--muted) !important;
  opacity: 1 !important;
}
input:disabled,
select:disabled,
textarea:disabled {
  background: #142033 !important;
  color: var(--muted) !important;
}
input:focus,
select:focus,
textarea:focus,
.input:focus,
.select:focus,
.textarea:focus {
  outline: none !important;
  box-shadow: 0 0 0 2px rgba(99, 102, 241, .4) !important; /* indigo */
  border-color: #6366f1 !important;
}

/* ---------- Botones secundarios sobrios ---------- */
.btn-secondary {
  background: var(--soft) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}
.btn-secondary:hover {
  filter: brightness(1.06);
}

/* ---------- Pastillas / chips / badges (horarios, sede, etc.) ---------- */
.badge,
.pill,
.tag,
.chip,
.pastilla,
.px-2.py-0\.5.rounded-full,
.px-2\.5.py-1\.5.rounded-xl,
.px-3.py-1\.5.rounded-xl,
.inline-flex.items-center.gap-2.rounded-xl {
  background: var(--chip-bg) !important;
  color: var(--chip-text) !important;
  border-color: var(--border) !important;
}

/* “Ver examen” (pill botón) */
a.inline-flex.items-center.gap-2.rounded-xl {
  background: var(--chip-bg) !important;
  color: var(--chip-text) !important;
  border-color: var(--border) !important;
}

/* ---------- Tablas (Usuarios, Boletín, Sets) ---------- */
table,
.table {
  background: transparent !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}
.table thead th,
thead th {
  background: var(--card) !important;
  color: var(--muted) !important;
  border-bottom-color: var(--border) !important;
}
.table tbody tr,
tbody tr { background: color-mix(in oklab, var(--card) 92%, black) !important; }
.table tbody tr:nth-child(2n),
tbody tr:nth-child(2n) { background: color-mix(in oklab, var(--card) 86%, black) !important; }
.table th,
.table td,
th, td { border-color: var(--border) !important; }

/* ---------- Grilla de asistencia ---------- */
.attendance-grid thead th,
.attendance-grid tbody td {
  background: var(--card) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}
.dot, .attendance-dot, .dot button {
  background: var(--soft) !important;
  border: 1px solid var(--border) !important;
}
.dot.is-checked,
.attendance-dot.is-checked {
  box-shadow: 0 0 0 2px var(--chip-bg) inset;
}

/* ---------- Skeletons ---------- */
.skeleton {
  background: linear-gradient(
    90deg,
    rgba(255,255,255,0.06),
    rgba(255,255,255,0.12),
    rgba(255,255,255,0.06)
  ) !important;
}

/* ---------- Separadores / líneas ---------- */
hr, .border-t, .border-b, .divide-y > * + * {
  border-color: var(--border) !important;
}

/* ---------- Links dentro de cards ---------- */
.card a.link, .card a { color: var(--link) !important; }

/* ---------- Bloques tipo “hoja” (boletín/reportes/parciales) ---------- */
.prose,
.content,
.sheet,
.paper,
.paper-like,
.rounded-3xl,
.rounded-2xl.bg-white {
  background: var(--card) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

/* ---------- Boxes internos de Exam Models (nota / toggle) ---------- */
.exam-card-inner,
.rounded-lg.bg-neutral-50,
.rounded-xl.bg-neutral-50,
.rounded-xl.border.bg-neutral-50 {
  background: var(--soft) !important;
  border-color: var(--border) !important;
}

/* ===== Fix extra: Student Communications sheet in dark ===== */

/* El “papel” blanco de la card (varias variantes comunes) */
#student-communications .message-card,
#student-communications .message,
#student-communications .post,
#student-communications .communication,
.student-communications .message-card,
.student-communications .message,
.student-communications .post,
.student-communications .communication,
.bg-white.rounded-xl,
.bg-white.rounded-2xl,
.bg-white.rounded-3xl,
.card .bg-white {
  background: var(--card) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

/* Burbujas internas (citas, líneas, etc.) */
#student-communications blockquote,
.student-communications blockquote {
  background: var(--soft) !important;
  border-color: var(--border) !important;
  color: var(--text) !important;
}

#student-communications hr,
.student-communications hr {
  border-color: var(--border) !important;
}

/* Timestamp/leyendas muy claras */
#student-communications .timestamp,
#student-communications .date,
#student-communications .meta,
.student-communications .timestamp,
.student-communications .date,
.student-communications .meta,
.text-neutral-300, .text-gray-300 {
  color: var(--muted) !important;
}

/* =======================
   Legibilidad en móvil
   ======================= */
@media (max-width: 640px) {
  html, body {
    /* iOS Safari/WebView a veces achica/engorda letras */
    -webkit-text-size-adjust: 100%;
  }

  /* Suaviza y optimiza el render del texto */
  .student-communications .comm-card,
  .student-communications .comm-card * {
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }

  /* En pantallas chicas subimos el contraste de los textos tenues */
  .student-communications .comm-card small,
  .student-communications .comm-card .muted,
  .student-communications .comm-card .text-neutral-600,
  .student-communications .comm-card .text-neutral-700,
  .student-communications .comm-card .text-neutral-500 {
    color: var(--text) !important;
  }

  /* Placeholder más visible */
  .student-communications textarea::placeholder {
    color: var(--muted) !important;
    opacity: .9;
  }
}
